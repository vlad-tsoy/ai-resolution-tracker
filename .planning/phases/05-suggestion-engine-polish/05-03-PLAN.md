---
phase: 05-suggestion-engine-polish
plan: 03
type: execute
wave: 2
depends_on: ["05-02"]
files_modified:
  - src/components/weekend/progress-overview.tsx
  - src/components/weekend/weekend-card.tsx
  - src/components/weekend/weekend-grid.tsx
  - src/components/weekend/category-section.tsx
  - src/app/(dashboard)/template.tsx
autonomous: true

must_haves:
  truths:
    - "Progress bar animates smoothly when its value changes (spring physics, not instant snap)"
    - "Weekend cards appear with staggered entrance animation on page load"
    - "Page transitions have a subtle fade-in / slide-up enter animation"
    - "All animations respect prefers-reduced-motion"
    - "No exit animations attempted on route changes (known App Router limitation)"
  artifacts:
    - path: "src/components/weekend/progress-overview.tsx"
      provides: "Progress bar with motion spring animation"
    - path: "src/components/weekend/weekend-card.tsx"
      provides: "WeekendCard with motion.div item variant"
    - path: "src/components/weekend/category-section.tsx"
      provides: "CategorySection with staggered container variant"
    - path: "src/app/(dashboard)/template.tsx"
      provides: "Page enter animation wrapper"
  key_links:
    - from: "src/components/weekend/category-section.tsx"
      to: "motion/react"
      via: "motion.div with staggerChildren variants"
      pattern: "staggerChildren"
    - from: "src/components/weekend/progress-overview.tsx"
      to: "motion/react"
      via: "motion.div animating progress bar width"
      pattern: "motion\\.div.*animate.*width"
    - from: "src/app/(dashboard)/template.tsx"
      to: "motion/react"
      via: "motion.div wrapping children for page enter"
      pattern: "motion\\.div.*initial.*animate"
---

<objective>
Add purposeful animations to existing UI components using the Motion library -- animated progress bar, staggered card entrances, and page enter transitions.

Purpose: These animations transform the app from functional to polished. They communicate state changes (progress), create visual rhythm (stagger), and smooth navigation (page transitions) -- making the tracker feel premium rather than utilitarian.
Output: Existing components enhanced with motion, plus a new `template.tsx` for page-level enter animations.
</objective>

<execution_context>
@/Users/vladimirtsoy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vladimirtsoy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-suggestion-engine-polish/05-RESEARCH.md
@.planning/phases/05-suggestion-engine-polish/05-02-SUMMARY.md

@src/components/weekend/progress-overview.tsx
@src/components/weekend/weekend-card.tsx
@src/components/weekend/weekend-grid.tsx
@src/components/ui/progress.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Animate progress bar with Motion spring</name>
  <files>src/components/weekend/progress-overview.tsx</files>
  <action>
Convert `ProgressOverview` to a Client Component (add `"use client"` directive) and replace the shadcn `Progress` component with a custom motion-animated progress bar.

Why client component: Motion spring animations require client-side JavaScript for the physics calculation and interpolation.

Replace the shadcn `<Progress>` component with a custom animated bar:

```tsx
"use client";

import { motion } from "motion/react";

// ... keep existing ProgressOverviewProps type

export function ProgressOverview({ completed, total }: ProgressOverviewProps) {
  const percent = total > 0 ? Math.round((completed / total) * 100) : 0;

  return (
    <div className="space-y-2">
      <div className="flex items-center justify-between">
        <h2 className="text-sm font-medium text-muted-foreground">
          Overall Progress
        </h2>
        <span className="text-sm font-medium">
          {completed}/{total} weekends &middot; {percent}%
        </span>
      </div>
      <div className="bg-primary/20 relative h-2 w-full overflow-hidden rounded-full">
        <motion.div
          className="bg-primary h-full rounded-full"
          initial={{ width: 0 }}
          animate={{ width: `${percent}%` }}
          transition={{ type: "spring", visualDuration: 0.6, bounce: 0.15 }}
        />
      </div>
    </div>
  );
}
```

Remove the `import { Progress } from "@/components/ui/progress"` import since we are replacing it with a motion div. Keep the `aria-label` accessibility by adding it to the outer div:
```tsx
<div className="bg-primary/20 ..." role="progressbar" aria-valuenow={percent} aria-valuemin={0} aria-valuemax={100} aria-label={`${completed} of ${total} weekends completed`}>
```

The spring animation gives a natural, bouncy feel when the progress value changes (e.g., after completing a weekend), instead of an instant snap.
  </action>
  <verify>`npm run build` succeeds. Visit overview page -- progress bar should animate from 0 to current value on page load with a spring motion.</verify>
  <done>Progress bar uses motion spring animation. Animates from 0 on initial load and smoothly transitions when value changes. Accessible with role="progressbar" and aria attributes.</done>
</task>

<task type="auto">
  <name>Task 2: Add staggered card entrance and page enter transition</name>
  <files>src/components/weekend/weekend-card.tsx, src/components/weekend/category-section.tsx, src/app/(dashboard)/template.tsx</files>
  <action>
**Modify `src/components/weekend/category-section.tsx`:**

Read the current file first. This is currently a Server Component rendering a grid of WeekendCards. Convert it to use motion for staggered entrance.

Add `"use client"` directive. Import `{ motion }` from `"motion/react"`.

Define stagger variants:
```typescript
const container = {
  hidden: { opacity: 0 },
  show: {
    opacity: 1,
    transition: {
      staggerChildren: 0.06,
    },
  },
};

const item = {
  hidden: { opacity: 0, y: 12 },
  show: { opacity: 1, y: 0 },
};
```

Wrap the grid div with `motion.div` using the container variant:
```tsx
<motion.div
  variants={container}
  initial="hidden"
  animate="show"
  className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"
>
  {weekends.map((weekend) => (
    <motion.div key={weekend.id} variants={item}>
      <WeekendCard weekend={weekend} />
    </motion.div>
  ))}
</motion.div>
```

Keep the section heading (h2) outside the motion container so it appears instantly.

**Verify `weekend-card.tsx` compatibility:**

WeekendCard is currently a Server Component. Since it is now being wrapped by a motion.div in the parent CategorySection (which is a Client Component), WeekendCard can remain a Server Component if it has no client hooks. Check: it uses only Link, Card, Badge, and icons -- all server-safe. Leave WeekendCard as-is (no changes needed). The motion wrapper is in the parent.

However, also update the bonus weekend section in `weekend-grid.tsx`. Read it first. If the bonus section renders inline (not via CategorySection), add a simple fade-in for the bonus card too:
- Convert `weekend-grid.tsx` to `"use client"` and import motion
- Wrap the bonus card in a `motion.div` with `initial={{ opacity: 0, y: 12 }}` and `animate={{ opacity: 1, y: 0 }}`
- The main CATEGORIES loop already uses CategorySection which now has stagger

**Create `src/app/(dashboard)/template.tsx`:**

This file provides page enter animations for all routes under `(dashboard)`. Per research, `template.tsx` re-mounts on every route change (unlike `layout.tsx`), making it ideal for enter-only animations.

```tsx
"use client";

import { motion } from "motion/react";

export default function Template({ children }: { children: React.ReactNode }) {
  return (
    <motion.div
      initial={{ opacity: 0, y: 8 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.3, ease: "easeOut" }}
    >
      {children}
    </motion.div>
  );
}
```

Do NOT attempt exit animations. Per research, exit animations with AnimatePresence in App Router are a known broken pattern (next.js#49279). Enter-only via template.tsx is the pragmatic approach.

Keep the animation subtle -- `y: 8` (not 20+), `duration: 0.3` (not 0.5+). This is an Apple-minimalist app; animations should be felt, not seen.
  </action>
  <verify>
1. `npm run build` succeeds
2. Visit overview page -- cards should appear with staggered fade-in/slide-up within each category section
3. Navigate to a detail page and back -- both pages should have a subtle enter animation (fade + slight upward slide)
4. The bonus weekend card should also animate in
  </verify>
  <done>
Weekend cards stagger in with 60ms delay between each card per category. Pages have subtle 300ms fade+slide enter animation via template.tsx. Bonus card animates in. No exit animations attempted. All animations are subtle and consistent with Apple-minimalist design.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds with no errors
2. Progress bar spring-animates from 0 to current value on page load
3. Weekend cards stagger in within each category section
4. Page transitions have subtle enter animation (fade + slide)
5. Navigating from overview to detail and back shows enter animations on both
6. Bonus weekend card animates in
7. No exit animation attempts (no AnimatePresence for routes)
8. No hydration mismatches or SSR errors
</verification>

<success_criteria>
- Progress bar uses motion spring animation with natural bounce
- Cards stagger in with 60ms delay between siblings
- template.tsx provides page-level enter animation for all dashboard routes
- All animations subtle (small offsets, short durations) matching Apple-minimalist design
- No SSR/hydration errors, build succeeds
- Requirement UI-02 satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/05-suggestion-engine-polish/05-03-SUMMARY.md`
</output>
