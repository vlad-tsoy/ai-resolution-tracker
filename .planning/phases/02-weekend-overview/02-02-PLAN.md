---
phase: 02-weekend-overview
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/app/(dashboard)/weekend/[id]/page.tsx
  - src/app/(dashboard)/weekend/[id]/loading.tsx
  - src/components/weekend/weekend-detail.tsx
  - src/components/weekend/work-item-list.tsx
autonomous: true

must_haves:
  truths:
    - "Clicking a weekend card on the overview navigates to a detail page with full weekend info"
    - "The detail page shows deliverable, core work items, advanced modifiers (marked optional), why it matters, and done-when criteria"
    - "Advanced modifiers are visually distinguished as optional extras"
    - "Invalid weekend IDs (non-numeric or nonexistent) show a 404 page"
    - "The detail page has a skeleton loading state during data fetch"
    - "The detail page has a back link to the overview"
    - "The detail page layout works on both mobile and desktop"
  artifacts:
    - path: "src/app/(dashboard)/weekend/[id]/page.tsx"
      provides: "Weekend detail page (Server Component with dynamic route)"
      min_lines: 15
    - path: "src/app/(dashboard)/weekend/[id]/loading.tsx"
      provides: "Skeleton loading state for detail page"
      min_lines: 10
    - path: "src/components/weekend/weekend-detail.tsx"
      provides: "Full weekend detail display component"
      exports: ["WeekendDetail"]
    - path: "src/components/weekend/work-item-list.tsx"
      provides: "Read-only work items display with advanced modifier distinction"
      exports: ["WorkItemList"]
  key_links:
    - from: "src/app/(dashboard)/weekend/[id]/page.tsx"
      to: "src/lib/queries.ts"
      via: "Server Component import"
      pattern: "getWeekendById"
    - from: "src/app/(dashboard)/weekend/[id]/page.tsx"
      to: "next/navigation"
      via: "notFound() for invalid IDs"
      pattern: "notFound"
    - from: "src/components/weekend/weekend-card.tsx"
      to: "src/app/(dashboard)/weekend/[id]/page.tsx"
      via: "Link href"
      pattern: "/weekend/\\d+"
---

<objective>
Build the weekend detail page -- the drill-down view showing full weekend information when a user clicks a card on the overview.

Purpose: Delivers requirements DETAIL-01 (full weekend info), DETAIL-04 (advanced modifiers as optional), UI-04 (responsive detail layout), and UI-05 (detail skeleton loading). Completes the read path so users can browse and explore all weekend content.
Output: A working detail page at `/weekend/[id]` showing deliverable, core work items, advanced modifiers, "why it matters", and "done when" criteria with skeleton loading and 404 handling.
</objective>

<execution_context>
@/Users/vladimirtsoy/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vladimirtsoy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-weekend-overview/02-RESEARCH.md
@.planning/phases/02-weekend-overview/02-01-SUMMARY.md

# Phase 1 outputs (schema, db connection)
@src/db/schema.ts
@src/lib/db.ts

# Plan 01 outputs (queries, components)
@src/lib/queries.ts
@src/components/weekend/weekend-card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create detail page components</name>
  <files>
    src/components/weekend/work-item-list.tsx
    src/components/weekend/weekend-detail.tsx
  </files>
  <action>
Create the presentational components for the weekend detail view. Reference the Phase 2 research file for code patterns.

**src/components/weekend/work-item-list.tsx** -- Read-only work items display:
- Props: `items: { id: number; title: string; isAdvanced: boolean; isCompleted: boolean }[]`, `title: string`
- Renders a section with `<h2>` heading and an `<ul>` list.
- Each item shows a read-only status indicator: completed items show a checkmark icon (CheckCircle2 from lucide-react in a muted success color), incomplete items show an empty circle (Circle from lucide-react in muted-foreground).
- Item text alongside the icon.
- This is read-only in Phase 2. Checkboxes become interactive in Phase 3.
- No "use client" directive needed -- pure Server Component rendering.

**src/components/weekend/weekend-detail.tsx** -- Full weekend detail component:
- Props: The return type of `getWeekendById` (inferred from Drizzle query, non-null). Accept it as a generic weekend prop with `workItems` and `doneCriteria` arrays.
- Layout: `<article className="max-w-2xl mx-auto space-y-8">` for readable content width.
- Sections in order:
  1. **Back navigation**: Link back to `/` with an ArrowLeft icon and "Back to weekends" text. Use `<Link href="/">` from next/link. Style: `text-sm text-muted-foreground hover:text-foreground transition-colors flex items-center gap-1`.
  2. **Header**: Weekend number as muted label ("Weekend {number}"), name as `<h1 className="text-2xl font-bold tracking-tight">`, deliverable as `<p className="text-muted-foreground">`.
  3. **Core Work Items**: Use `<WorkItemList>` component with title "Core Work" and items filtered to `!isAdvanced`.
  4. **Advanced Modifiers**: Only render if there are advanced items. Section heading "Advanced Modifiers" with a shadcn `<Badge variant="outline">` showing "Optional" next to the heading. Use `<WorkItemList>` with items filtered to `isAdvanced`. Style the entire section slightly muted (`text-muted-foreground`) to visually de-emphasize.
  5. **Why It Matters**: Section heading "Why It Matters" with the `whyItMatters` text rendered as a paragraph. Only render if `whyItMatters` is not null/empty.
  6. **Done When**: Section heading "Done When" with `doneCriteria` rendered as a list. Each criterion shows its `description` text. Use checkmark icons for `isMet` criteria and circle icons for unmet ones (same pattern as work items, read-only).
- Import Badge from shadcn/ui, Link from next/link, ArrowLeft from lucide-react.
  </action>
  <verify>
Run `npx tsc --noEmit` and confirm no TypeScript errors in the new files. All imports resolve correctly.
  </verify>
  <done>
Two detail display components created. WeekendDetail shows all weekend sections in proper order with back navigation. WorkItemList renders read-only items with status icons. Advanced modifiers clearly marked as optional.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build detail route and skeleton loading</name>
  <files>
    src/app/(dashboard)/weekend/[id]/page.tsx
    src/app/(dashboard)/weekend/[id]/loading.tsx
  </files>
  <action>
Create the dynamic route page and its skeleton loading state.

**src/app/(dashboard)/weekend/[id]/page.tsx** -- Weekend detail page (async Server Component):
- This is an `async` Server Component (no "use client").
- CRITICAL: In Next.js 16, `params` is a Promise and must be awaited:
  ```typescript
  export default async function WeekendPage({
    params,
  }: {
    params: Promise<{ id: string }>
  }) {
    const { id } = await params;
  ```
- Parse ID: `const weekendId = parseInt(id)`. If `isNaN(weekendId)`, call `notFound()` from `next/navigation`.
- Fetch data: `const weekend = await getWeekendById(weekendId)` using the query function from `@/lib/queries`.
- If `!weekend`, call `notFound()`.
- Render `<WeekendDetail weekend={weekend} />`.
- Optionally add `generateMetadata` for dynamic page title:
  ```typescript
  export async function generateMetadata({ params }: { params: Promise<{ id: string }> }) {
    const { id } = await params;
    const weekend = await getWeekendById(parseInt(id));
    return { title: weekend ? `Weekend ${weekend.number}: ${weekend.name}` : 'Not Found' };
  }
  ```
  Note: Next.js deduplicates the `getWeekendById` call between `generateMetadata` and the page component, so the database is only queried once.

**src/app/(dashboard)/weekend/[id]/loading.tsx** -- Detail skeleton:
- Must match the real detail layout to avoid layout shift.
- Structure (matching WeekendDetail layout):
  1. Back link skeleton: `<Skeleton className="h-4 w-32" />`
  2. Header: Skeleton for weekend number label (`h-4 w-20`), name (`h-8 w-2/3`), deliverable (`h-4 w-full`)
  3. Core Work section: Heading skeleton (`h-6 w-24`) + 4-5 item skeletons (each `h-4 w-full` with a small circle skeleton)
  4. Advanced section: Heading skeleton (`h-6 w-40`) + 2-3 item skeletons
  5. Why It Matters: Heading skeleton + 2 line skeletons
  6. Done When: Heading skeleton + 3 item skeletons
- Use same container: `<article className="max-w-2xl mx-auto space-y-8">`.
- Use `<div className="space-y-3">` within each section to match real spacing.
  </action>
  <verify>
Run the dev server and test:
1. Navigate to `/weekend/1` -- detail page loads with full weekend info.
2. Navigate to `/weekend/999` -- 404 page appears.
3. Navigate to `/weekend/abc` -- 404 page appears.
4. Click "Back to weekends" link -- returns to overview.
5. From overview, click any weekend card -- navigates to correct detail page.
6. Throttle network in DevTools -- skeleton loading state appears during navigation.
7. Check page title in browser tab shows "Weekend N: Name".
8. On mobile viewport (375px), content is readable and doesn't overflow.
9. On desktop viewport, content is centered with max-w-2xl constraint.
  </verify>
  <done>
Detail page at `/weekend/[id]` renders full weekend information with proper 404 handling, skeleton loading, dynamic metadata, and back navigation. The complete read path (overview -> detail -> back) works end-to-end.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `npm run build` completes without build errors
3. `/weekend/1` shows full detail: name, deliverable, core work items, advanced modifiers (with "Optional" badge), why it matters, done-when criteria
4. `/weekend/999` and `/weekend/abc` both show 404
5. Back navigation from detail returns to overview
6. Detail skeleton appears during navigation (test with network throttling)
7. Browser tab shows dynamic title "Weekend N: Name"
8. Detail layout is readable on mobile (375px) and centered on desktop
9. Advanced modifiers section is visually de-emphasized compared to core work
10. Full round-trip works: overview -> click card -> detail -> back to overview
</verification>

<success_criteria>
The complete read path is functional. Users can browse all weekends on the overview page, click into any weekend to see its full details (deliverable, core work, advanced modifiers marked optional, why it matters, done-when criteria), and navigate back. Invalid IDs gracefully show 404. Both pages have skeleton loading states. The layout works on mobile and desktop.
</success_criteria>

<output>
After completion, create `.planning/phases/02-weekend-overview/02-02-SUMMARY.md`
</output>
